name: Update developer guide

on:
  workflow_dispatch:
  schedule:
    - cron: '0 7 * * *'

jobs:
  update-developer-guide:
    runs-on: ubuntu-latest

    steps:
      - name: Pull readmes and push updates
        run: |
          git clone "https://${{ secrets.GIT_USERNAME }}:${{ secrets.SCHUTZBOT_TOKEN }}@github.com/osbuild/osbuild.github.io.git"
          cd osbuild.github.io
          git config user.email "${{ secrets.GIT_EMAIL }}"
          git config user.name "${{ secrets.GIT_USERNAME }}"

          ./pull-readmes.sh readme-list

          git add .
          git commit -m "Automated developer guide update"

          git push origin main
